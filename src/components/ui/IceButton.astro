---
import { Icon } from "astro-icon/components";

interface Props {
  text: string;
  href?: string;
  variant?: "primary" | "secondary";
  size?: "small" | "medium" | "large";
  class?: string;
  icon?: string;
  onClick?: string;
  [key: string]: unknown;
}

const { text, href, variant = "primary", size = "medium", class: className = "", icon, onClick, ...rest } = Astro.props;

const Tag = href ? "a" : "button";
const sizeClasses = {
  small: "px-2 md:px-6 py-3 xl:px-[24px] xl:py-[12px] text-sm xl:text-[14px] xl:leading-[20px]",
  medium: "px-3 md:px-8 py-4 text-base xl:text-[16px] xl:leading-[24px]",
  large: "px-10 py-5 xl:px-[40px] xl:py-[20px] text-lg xl:text-[20px] xl:leading-[28px]",
};
---

<Tag
  class={`ice-button ice-button-${variant} ice-button-${size} ${className} relative inline-flex items-center justify-center font-bold rounded-full transition-all duration-300 overflow-hidden group ${sizeClasses[size]}`}
  href={href}
  onclick={onClick}
  {...rest}
>
  <!-- Ice Background Animation -->
  <div class="ice-bg absolute inset-0 rounded-full"></div>

  <!-- Floating Ice Crystals -->
  <div class="ice-crystals absolute inset-0 rounded-full overflow-hidden">
    <div class="ice-crystal ice-crystal-1">❄</div>
    <div class="ice-crystal ice-crystal-2">❅</div>
    <div class="ice-crystal ice-crystal-3">❄</div>
    <div class="ice-crystal ice-crystal-4">❅</div>
    <div class="ice-crystal ice-crystal-5">❄</div>
    <div class="ice-crystal ice-crystal-6">❅</div>
    <div class="ice-crystal ice-crystal-7">❄</div>
    <div class="ice-crystal ice-crystal-8">❅</div>
  </div>

  <!-- Frost Particles -->
  <div class="frost-particles absolute inset-0 rounded-full overflow-hidden">
    <div class="frost-particle frost-particle-1"></div>
    <div class="frost-particle frost-particle-2"></div>
    <div class="frost-particle frost-particle-3"></div>
    <div class="frost-particle frost-particle-4"></div>
    <div class="frost-particle frost-particle-5"></div>
    <div class="frost-particle frost-particle-6"></div>
  </div>

  <!-- Inner Frost Glow -->
  <div class="ice-glow absolute inset-0 rounded-full opacity-0 group-hover:opacity-100 transition-opacity duration-300">
  </div>

  <!-- Button Content -->
  <span class="relative z-10 flex items-center gap-2">
    {text}
    {
      icon && (
        <Icon
          name={icon}
          class="w-6 h-6 xl:w-[24px] xl:h-[24px] ml-3 xl:ml-[12px] group-hover:translate-x-2 group-hover:scale-110 transition-all duration-300"
        />
      )
    }
  </span>

  <!-- Freeze Effect Overlay -->
  <div
    class="freeze-effect absolute inset-0 rounded-full opacity-0 group-active:opacity-100 transition-opacity duration-150"
  >
  </div>
</Tag>

<style>
  .ice-button {
    position: relative;
    border: none;
    cursor: pointer;
    text-decoration: none;
    user-select: none;
    transform-style: preserve-3d;
  }

  /* Primary Ice Button */
  .ice-button-primary {
    background: linear-gradient(135deg, #e0f2fe 0%, #b3e5fc 25%, #81d4fa 50%, #4fc3f7 75%, #29b6f6 100%);
    color: #0d47a1;
    text-shadow: 0 1px 2px rgba(255, 255, 255, 0.5);
    box-shadow:
      0 4px 15px rgba(33, 150, 243, 0.4),
      0 2px 10px rgba(129, 212, 250, 0.3),
      inset 0 1px 0 rgba(255, 255, 255, 0.6),
      inset 0 -1px 0 rgba(33, 150, 243, 0.2);
    border: 1px solid rgba(33, 150, 243, 0.3);
  }

  .ice-button-primary:hover {
    background: linear-gradient(135deg, #f3e5f5 0%, #e1bee7 25%, #ce93d8 50%, #ba68c8 75%, #ab47bc 100%);
    box-shadow:
      0 6px 25px rgba(33, 150, 243, 0.6),
      0 4px 15px rgba(129, 212, 250, 0.4),
      inset 0 1px 0 rgba(255, 255, 255, 0.8),
      inset 0 -1px 0 rgba(33, 150, 243, 0.3);
    transform: translateY(-2px) scale(1.02);
  }

  .ice-button-primary:active {
    transform: translateY(0) scale(0.98);
    box-shadow:
      0 2px 10px rgba(33, 150, 243, 0.5),
      0 1px 5px rgba(129, 212, 250, 0.3),
      inset 0 2px 4px rgba(33, 150, 243, 0.2);
  }

  /* Secondary Ice Button */
  .ice-button-secondary {
    background: linear-gradient(135deg, rgba(255, 255, 255, 0.2) 0%, rgba(129, 212, 250, 0.3) 100%);
    color: #014477;
    border: 2px solid rgba(129, 212, 250, 0.6);
    backdrop-filter: blur(10px);
    text-shadow: 0 1px 2px rgba(255, 255, 255, 0.3);
  }

  .ice-button-secondary:hover {
    background: linear-gradient(135deg, rgba(129, 212, 250, 0.3) 0%, rgba(33, 150, 243, 0.4) 100%);
    border-color: #29b6f6;
    color: #014477;
    box-shadow: 0 0 20px rgba(129, 212, 250, 0.5);
    transform: translateY(-2px) scale(1.02);
  }

  .ice-button-secondary:active {
    transform: translateY(0) scale(0.98);
  }

  /* Ice Background Animation */
  .ice-bg {
    background: radial-gradient(
      ellipse at center,
      rgba(129, 212, 250, 0.3) 0%,
      rgba(33, 150, 243, 0.2) 30%,
      rgba(3, 169, 244, 0.1) 60%,
      transparent 100%
    );
    animation: iceShimmer 3s ease-in-out infinite alternate;
  }

  @keyframes iceShimmer {
    0% {
      opacity: 0.6;
      transform: scale(1) rotate(0deg);
    }
    25% {
      opacity: 0.8;
      transform: scale(1.02) rotate(-0.5deg);
    }
    50% {
      opacity: 0.9;
      transform: scale(0.99) rotate(0.3deg);
    }
    75% {
      opacity: 1;
      transform: scale(1.01) rotate(-0.2deg);
    }
    100% {
      opacity: 0.7;
      transform: scale(1) rotate(0.1deg);
    }
  }

  /* Ice Crystals */
  .ice-crystal {
    position: absolute;
    font-size: 18px;
    color: rgba(255, 255, 255, 0.95);
    animation: crystalFloat 6s infinite linear;
    opacity: 0;
    text-shadow:
      0 0 8px rgba(129, 212, 250, 0.8),
      0 0 4px rgba(255, 255, 255, 0.6),
      0 0 2px rgba(33, 150, 243, 0.4);
    filter: drop-shadow(0 0 3px rgba(129, 212, 250, 0.7));
    z-index: 5;
  }

  .ice-crystal-1 {
    left: 10%;
    animation-delay: 0s;
    animation-duration: 8s;
  }

  .ice-crystal-2 {
    left: 25%;
    animation-delay: 1s;
    animation-duration: 6s;
  }

  .ice-crystal-3 {
    left: 40%;
    animation-delay: 2s;
    animation-duration: 7s;
  }

  .ice-crystal-4 {
    left: 55%;
    animation-delay: 3s;
    animation-duration: 5s;
  }

  .ice-crystal-5 {
    left: 70%;
    animation-delay: 4s;
    animation-duration: 9s;
  }

  .ice-crystal-6 {
    left: 85%;
    animation-delay: 5s;
    animation-duration: 6.5s;
  }

  .ice-crystal-7 {
    left: 15%;
    animation-delay: 2.5s;
    animation-duration: 7.5s;
  }

  .ice-crystal-8 {
    left: 60%;
    animation-delay: 1.5s;
    animation-duration: 8.5s;
  }

  @keyframes crystalFloat {
    0% {
      top: -15%;
      opacity: 0;
      transform: translateX(0) translateY(0) rotate(0deg) scale(0.8);
    }
    5% {
      opacity: 0.9;
    }
    15% {
      opacity: 1;
      transform: translateX(-5px) translateY(20px) rotate(45deg) scale(1);
    }
    35% {
      opacity: 0.9;
      transform: translateX(8px) translateY(60px) rotate(135deg) scale(1.1);
    }
    55% {
      opacity: 0.8;
      transform: translateX(-3px) translateY(100px) rotate(225deg) scale(0.9);
    }
    75% {
      opacity: 0.6;
      transform: translateX(6px) translateY(140px) rotate(315deg) scale(1);
    }
    95% {
      opacity: 0.2;
      transform: translateX(-2px) translateY(180px) rotate(405deg) scale(1.2);
    }
    100% {
      top: 115%;
      opacity: 0;
      transform: translateX(4px) translateY(200px) rotate(450deg) scale(0.6);
    }
  }

  /* Frost Particles */
  .frost-particle {
    position: absolute;
    width: 2px;
    height: 2px;
    background: radial-gradient(circle, #e3f2fd 0%, #bbdefb 50%, transparent 100%);
    border-radius: 50%;
    animation: frostDrift 5s infinite linear;
    opacity: 0;
    box-shadow: 0 0 3px rgba(129, 212, 250, 0.5);
  }

  .frost-particle-1 {
    left: 20%;
    animation-delay: 0s;
    animation-duration: 4s;
  }

  .frost-particle-2 {
    left: 40%;
    animation-delay: 1s;
    animation-duration: 5s;
  }

  .frost-particle-3 {
    left: 60%;
    animation-delay: 2s;
    animation-duration: 4.5s;
  }

  .frost-particle-4 {
    left: 80%;
    animation-delay: 3s;
    animation-duration: 5.5s;
  }

  .frost-particle-5 {
    left: 30%;
    animation-delay: 1.5s;
    animation-duration: 4.2s;
  }

  .frost-particle-6 {
    left: 70%;
    animation-delay: 2.5s;
    animation-duration: 4.8s;
  }

  @keyframes frostDrift {
    0% {
      top: -10%;
      opacity: 0;
      transform: translateX(0) translateY(0) scale(0.3);
    }
    10% {
      opacity: 0.8;
    }
    25% {
      opacity: 1;
      transform: translateX(-8px) translateY(25px) scale(0.6);
    }
    50% {
      opacity: 0.9;
      transform: translateX(12px) translateY(50px) scale(0.8);
    }
    75% {
      opacity: 0.6;
      transform: translateX(-5px) translateY(75px) scale(1);
    }
    90% {
      opacity: 0.3;
      transform: translateX(8px) translateY(90px) scale(1.2);
    }
    100% {
      top: 110%;
      opacity: 0;
      transform: translateX(-3px) translateY(100px) scale(1.5);
    }
  }

  /* Inner Ice Glow Effect */
  .ice-glow {
    background: radial-gradient(
      ellipse at center,
      rgba(224, 242, 254, 0.5) 0%,
      rgba(129, 212, 250, 0.4) 40%,
      rgba(33, 150, 243, 0.3) 70%,
      transparent 100%
    );
    animation: frostGlow 2s ease-in-out infinite alternate;
  }

  @keyframes frostGlow {
    0% {
      opacity: 0.4;
      transform: scale(0.9);
    }
    100% {
      opacity: 1;
      transform: scale(1.1);
    }
  }

  /* Freeze Effect */
  .freeze-effect {
    background: radial-gradient(
      circle at center,
      rgba(255, 255, 255, 0.6) 0%,
      rgba(129, 212, 250, 0.3) 50%,
      transparent 100%
    );
  }

  /* Hover Enhancements */
  .ice-button:hover .ice-crystal {
    animation-duration: 4s;
    opacity: 1;
    filter: drop-shadow(0 0 6px rgba(129, 212, 250, 0.9));
  }

  .ice-button:hover .frost-particle {
    animation-duration: 2.5s;
  }

  .ice-button:hover .ice-bg {
    animation-duration: 1.5s;
  }

  /* Size Variations */
  .ice-button-small .ice-crystal {
    font-size: 14px;
  }

  .ice-button-small .frost-particle {
    width: 1.5px;
    height: 1.5px;
  }

  .ice-button-large .ice-crystal {
    font-size: 22px;
  }

  .ice-button-large .frost-particle {
    width: 3px;
    height: 3px;
  }

  /* Accessibility */
  .ice-button:focus {
    outline: 2px solid rgba(129, 212, 250, 0.8);
    outline-offset: 2px;
  }

  .ice-button:focus:not(:focus-visible) {
    outline: none;
  }

  /* Disabled State */
  .ice-button:disabled {
    opacity: 0.6;
    cursor: not-allowed;
    transform: none !important;
  }

  .ice-button:disabled .ice-crystal,
  .ice-button:disabled .frost-particle,
  .ice-button:disabled .ice-bg {
    animation-play-state: paused;
  }

  /* Special Winter Effects */
  .ice-button:hover {
    filter: brightness(1.1) contrast(1.05);
  }

  .ice-button-primary:hover {
    background: linear-gradient(135deg, #f8f9ff 0%, #e8f4fd 25%, #d1e7dd 50%, #b8e6ff 75%, #9fccfa 100%);
  }
</style>
